# OSPF协议（传输层协议）

## 定义

开放最短路径优先（OSPF，Open Shortest Path First）是一个基于链路状态的内部网关协议（IGP），用于在单一自治系统（AS）内进行路由选择。它由IETF开发，设计为在大型和复杂网络中高效和快速地确定最佳路由路径。

## 组成部分

1.OSPF区域

通过将大型网络划分为多个区域，简化路由管理和减小路由表的大小。

2.链路状态广告（LSA）

路由器定期生成和交换链路状态信息，构建网络拓扑图。

3.OSPF数据库

每个路由器维护一个链路状态数据库，存储从所有其他路由器收到的LSA。

4.OSPF报文

包括Hello、DBD、LSR、LSU、LSAck等，用于邻居发现、链路状态更新等功能。

## 结构形式

1.区域间路由

通过ABR（区域边界路由器）连接不同区域，实现区域间通信。

2.骨干区域（Area 0）

所有区域必须连接到骨干区域，用于区域间路由信息交换。

3.链路状态数据库同步

路由器通过交换LSA保持链路状态数据库的同步。

4.OSPF分组

![image-20240622214135855](../TyporaImage/image-20240622214135855.png)

## 分类

1.单区域OSPF

整个网络作为一个区域，适用于小型网络。

2.多区域OSPF将

网络划分为多个区域，适用于大型和复杂网络。

3.OSPFv2

用于IPv4网络的OSPF版本。

4.OSPFv3

用于IPv6网络的OSPF版本。



## 特征

1.快速收敛：路由变化能够快速传播到整个网络。
2.基于链路状态：每个路由器维护整个网络的拓扑视图。
3.支持多区域：通过划分区域简化路由管理，减小路由表。
4.支持VLSM和CIDR：能够处理可变长度子网掩码和无类域间路由选择。
5.安全性：支持路由更新认证，确保路由信息的完整性和真实性。

## 使用方法

### 1.链路状态信息交换

#### ①使用洪泛法向自治系统内所有路由器发送信息

即路由器通过输出端口向所有相邻路由器发送信息，而每一个相邻路由器又再次将此信息发送往其所有的相邻路由器。最终整个区域内所有路由器都得到了这个信息的一个副本。

#### ②发送的信息是什么

发送的信息是与本路由器相邻的所有路由器的链路状态（本路由器和哪些路由器相邻，以及该链路的度量/代价——费用、距离、时延、带宽等）。

#### ③多久交换

只有当链路状态发生变化时，路由器才向所有路由器洪泛发送此信息。
最后，所有路由器都能建立一个链路状态数据库，即全网拓扑图。

# 链路状态路由算法

## 定义

链路状态路由算法（Link State Routing Algorithm）是一种动态路由算法，基于网络中每个节点对其直接连接的链路状态的全面了解来计算路由。每个节点将其链路状态信息广播给网络中的其他节点，最终所有节点都能构建出整个网络的拓扑图，并使用最短路径算法（如Dijkstra算法）计算到其他节点的最短路径。

## 组成部分

1.链路状态包（LSP）

节点生成的包含其链路状态信息的数据包。

2.拓扑数据库

每个节点维护的链路状态信息数据库，存储从网络中其他节点收到的LSP。

3.路由计算

使用Dijkstra算法或其他最短路径算法计算到其他节点的最短路径。

## 结构形式

1.链路状态信息交换

节点通过洪泛法将LSP广播给网络中的所有其他节点。

2.拓扑图构建

每个节点根据收到的LSP构建整个网络的拓扑图。

3.路径计算

使用最短路径算法计算最佳路由路径。

## 分类

1.Dijkstra算法

经典的链路状态算法，用于计算从源节点到所有其他节点的最短路径。

2.OSPF协议

基于链路状态算法的路由协议，应用于内部网关路由选择。	


## 特征

1.全局视图：每个节点维护整个网络的拓扑图，具备全局视图。
2.快速收敛：路由变化能迅速传播和处理，确保网络快速收敛。
3.精确路由选择：基于精确的拓扑图计算最短路径，提供最优路由选择。

## 使用方法

1.链路状态信息生成

每个节点生成包含其链路状态信息的LSP。

2.信息洪泛

节点将LSP广播给网络中的所有其他节点。

3.拓扑数据库更新

节点接收并存储其他节点的LSP，更新其拓扑数据库。

4.路径计算

使用Dijkstra算法计算最短路径，更新路由表。